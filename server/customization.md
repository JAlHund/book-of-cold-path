# Настройка сервера

В прошлом пункте мы запустили сервер. Отлично! Мы уже сейчас можем играть на стандартной версии сервера. Но я уверен, что вы теперь хотите настроить его под себя
Выключим запущенный сервер (CTRL + C)
Настроим время на ход
```
nano server_settings.lua
```
Оно указано в секундах и по умолчанию равно 180. Давайте изменим на 210, чтобы было 3.5 минуты
С помощью стрелок на клавиатуре дойдите до этого числа и измените его (но не набирайте цифры на Numpad, набирайте их с помощью цифр, расположенных над буквами)
Отлично, изменили. Теперь нужно сохранить.
Нажмите CTRL + X
Потом y
Потом enter
Таким образом, вы можете редактировать файлы на сервере. Редактировать можно очень и очень многое.
Запустим снова наш сервер
Перейдем в основную папку сервера
Запускаем сервер
```
./start.sh
```
Теперь мы можем смотреть на то, что происходит в консоли. Также мы можем свернуть текущее окно. Наберите на клавиатуре:
CTRL + A
CTRL + D
Мы вышли из экрана сервера.
При подключении к серверу после того, как отключитесь, вы будете в такой же ситуации.
Чтобы снова загрузить экран сервера, пропишите
```
screen -r server1
```

## Добавление кастомного сценария


По умолчанию на сервере установлена карта и сценарий от активного игрока parkourcat. Это сделано, чтобы вам было проще поставить свои кастомные карты и сценарии, опираясь на существующий пример

Итак, мы хотим добавить свой сценарий на сервер.
(если вы сейчас только подключились к серверу, то не забудь ввести команду screen -r server1 из прошлого пункта, чтобы перейти в экран сервера. В случае, если вы перейдете и сервер запущен, то выключите его командой CTRL + C)

Вначале вы должны были создать сценарий в редакторе сценариев и экспортировать его в виде файла .lua
Полученный файл вам нужно закинуть на сервер в папку scripts/scenarios/<подходящая карта>

Дальше нужно определиться:
1) вы хотите, чтобы этот сценарий запускался при старте сценария
2) вы хотите, чтобы этот сценарий был одним из тех сценариев, которые автоматически начинаются после конца игры

Если первое, то вам нужно отредактировать файл start.lua
Открываем этот файл с помощью редактора
```
nano start.lua
```
Находим строку
```
game_data = require "scripts.scenarios.euro.std"
```
Меняем ее на 
```
game_data = require "scripts.scenarios.<карта>.<сценарий>"
```
Далее, как обычно, сохраняем
CTRL + X
вводим y
жмем enter

Если второе, то нам уже нужно отредактировать стандартный плагин game_switch (вы тоже можете писать свои плагины, но это отдельная и достаточно сложная тема. Для того, чтобы писать плагины, нужно программировать. Но это открывает очень большие возможности)
Переходим в core/server/plugins
```
cd core/server/plugins
```
Редактируем плагин game_switch
```
nano game_switch.lua
```
Дописываем нужный сценарий по аналогии со сценариями, которые уже определены
И по традиции CTRL + X
Вводим y
Жмем enter
Переходим в папку сервера
```
cd ../../..
```
(вверх на три уровня)

После проделанных действий запускаем сервер
./start.sh


## Добавление кастомной карты


1. Создайте карту в редакторе карт.
2. Создайте на сервере папку maps.
3. Папку exported_map переименуйте в id карты и положите в папку maps.
4. Добавьте свой сценарий, сделанный на этой пользовательской карте, на сервер

Игрокам ничего устанавливать не надо, карта подгрузится автоматически при заходе в игру.
